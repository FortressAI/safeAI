<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - Interactive Demo</title>
  <!-- React and ReactDOM -->
  <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
  <!-- Babel for JSX transpiling -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- Material-UI CDN -->
  <script src="https://unpkg.com/@mui/material@5.0.0/umd/material-ui.development.js" crossorigin></script>
  <!-- Plotly for charts -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
  <link rel="stylesheet" href="../css/shared-demo.css" />
  <style>
    .metric-card {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 20px;
      position: relative;
      overflow: hidden;
      transition: transform 0.2s;
    }
    
    .metric-card:hover {
      transform: translateY(-4px);
    }
    
    .metric-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
    }
    
    .metric-value {
      font-size: 32px;
      font-weight: bold;
      margin: 10px 0;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .metric-label {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.7);
    }
    
    .chart-container {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      height: 300px;
    }
    
    .activity-list {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 8px;
      padding: 20px;
    }
    
    .activity-item {
      display: flex;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      transition: background-color 0.2s;
    }
    
    .activity-item:hover {
      background-color: rgba(255, 255, 255, 0.05);
    }
    
    .activity-item:last-child {
      border-bottom: none;
    }
    
    .status-indicator {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-right: 8px;
    }
    
    .status-healthy { background-color: #4CAF50; }
    .status-warning { background-color: #FFC107; }
    .status-error { background-color: #F44336; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { 
      Box, Typography, Grid, Paper, List, ListItem, ListItemIcon, 
      ListItemText, Icon, LinearProgress, Tooltip, Alert
    } = MaterialUI;

    // Material icon names
    const ICONS = {
      SMART_TOY: "smart_toy",
      SPEED: "speed",
      TIMER: "timer",
      CHECK_CIRCLE: "check_circle",
      WARNING: "warning",
      ERROR: "error",
      REFRESH: "refresh"
    };

    // Sample data
    const initialMetrics = {
      activeAgents: 12,
      systemLoad: 45,
      responseTime: 0.8,
      successRate: 99.9
    };

    const initialActivityData = Array.from({length: 24}, (_, i) => ({
      time: i,
      ethics: Math.random() * 30 + 20,
      math: Math.random() * 30 + 20,
      arc: Math.random() * 30 + 20,
      security: Math.random() * 30 + 20
    }));

    const initialResourceData = Array.from({length: 60}, (_, i) => ({
      time: i,
      cpu: Math.random() * 30 + 40,
      memory: Math.random() * 20 + 50,
      network: Math.random() * 25 + 35
    }));

    const initialRecentActivity = [
      {
        id: 1,
        agent: 'Ethics Agent',
        action: 'Completed value alignment check',
        time: '2 minutes ago',
        status: 'healthy'
      },
      {
        id: 2,
        agent: 'Security Monitor',
        action: 'Detected and blocked suspicious activity',
        time: '5 minutes ago',
        status: 'warning'
      },
      {
        id: 3,
        agent: 'Math Agent',
        action: 'Solved complex optimization problem',
        time: '10 minutes ago',
        status: 'healthy'
      }
    ];

    // Metric Card Component
    function MetricCard({ label, value, trend, icon }) {
      return (
        <Paper className="metric-card">
          <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
            <Icon sx={{ mr: 1 }}>{icon}</Icon>
            <Typography variant="subtitle2" color="text.secondary">
              {label}
            </Typography>
          </Box>
          <Typography variant="h4" className="metric-value">
            {value}
          </Typography>
          <Typography variant="caption" color="text.secondary">
            {trend}
          </Typography>
        </Paper>
      );
    }

    // Activity Item Component
    function ActivityItem({ activity }) {
      return (
        <ListItem className="activity-item">
          <ListItemIcon>
            <Icon>{ICONS.SMART_TOY}</Icon>
          </ListItemIcon>
          <ListItemText
            primary={
              <Box sx={{ display: 'flex', alignItems: 'center' }}>
                <span className={`status-indicator status-${activity.status}`} />
                {activity.agent}
              </Box>
            }
            secondary={
              <Box>
                <Typography variant="body2">{activity.action}</Typography>
                <Typography variant="caption" color="text.secondary">
                  {activity.time}
                </Typography>
              </Box>
            }
          />
        </ListItem>
      );
    }

    // Main Dashboard Component
    function Dashboard() {
      const [metrics, setMetrics] = React.useState(initialMetrics);
      const [activityData, setActivityData] = React.useState(initialActivityData);
      const [resourceData, setResourceData] = React.useState(initialResourceData);
      const [recentActivity, setRecentActivity] = React.useState(initialRecentActivity);
      const [isLoading, setIsLoading] = React.useState(false);
      const [error, setError] = React.useState(null);

      // Effect for real-time updates
      React.useEffect(() => {
        const interval = setInterval(() => {
          updateMetrics();
        }, 2000);

        return () => clearInterval(interval);
      }, []);

      // Effect for chart initialization
      React.useEffect(() => {
        initializeCharts();
      }, [activityData, resourceData]);

      const updateMetrics = () => {
        setIsLoading(true);
        // Simulate API call
        setTimeout(() => {
          setMetrics(prev => ({
            ...prev,
            activeAgents: prev.activeAgents + Math.floor(Math.random() * 3) - 1,
            systemLoad: Math.floor(Math.random() * 20 + 40),
            responseTime: (Math.random() * 0.2 + 0.7).toFixed(1),
            successRate: (99.5 + Math.random() * 0.5).toFixed(1)
          }));
          setIsLoading(false);
        }, 500);
      };

      const initializeCharts = () => {
        // Agent Activity Chart
        const activityChart = document.getElementById('activityChart');
        if (activityChart) {
          Plotly.newPlot(activityChart, [{
            type: 'scatter',
            mode: 'lines',
            name: 'Ethics Agent',
            x: activityData.map(d => d.time),
            y: activityData.map(d => d.ethics),
            line: { color: '#4CAF50' }
          }, {
            type: 'scatter',
            mode: 'lines',
            name: 'Math Agent',
            x: activityData.map(d => d.time),
            y: activityData.map(d => d.math),
            line: { color: '#2196F3' }
          }, {
            type: 'scatter',
            mode: 'lines',
            name: 'ARC Agent',
            x: activityData.map(d => d.time),
            y: activityData.map(d => d.arc),
            line: { color: '#FFC107' }
          }, {
            type: 'scatter',
            mode: 'lines',
            name: 'Security Agent',
            x: activityData.map(d => d.time),
            y: activityData.map(d => d.security),
            line: { color: '#F44336' }
          }], {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            showlegend: true,
            legend: { font: { color: '#fff' } }
          });
        }

        // System Resources Chart
        const resourceChart = document.getElementById('resourceChart');
        if (resourceChart) {
          Plotly.newPlot(resourceChart, [{
            type: 'scatter',
            mode: 'lines',
            name: 'CPU',
            x: resourceData.map(d => d.time),
            y: resourceData.map(d => d.cpu),
            line: { color: '#4CAF50' }
          }, {
            type: 'scatter',
            mode: 'lines',
            name: 'Memory',
            x: resourceData.map(d => d.time),
            y: resourceData.map(d => d.memory),
            line: { color: '#2196F3' }
          }, {
            type: 'scatter',
            mode: 'lines',
            name: 'Network',
            x: resourceData.map(d => d.time),
            y: resourceData.map(d => d.network),
            line: { color: '#FFC107' }
          }], {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#fff' },
            showlegend: true,
            legend: { font: { color: '#fff' } }
          });
        }
      };

      return (
        <Box sx={{ p: 3 }}>
          <Typography variant="h4" gutterBottom>
            Dashboard
          </Typography>
          <Typography variant="subtitle1" color="text.secondary" paragraph>
            Real-time monitoring of SafeAI system performance
          </Typography>

          {error && (
            <Alert severity="error" sx={{ mb: 2 }}>
              {error}
            </Alert>
          )}

          <Grid container spacing={3}>
            <Grid item xs={12} sm={6} md={3}>
              <MetricCard
                label="Active Agents"
                value={metrics.activeAgents}
                trend="+2 from last hour"
                icon={ICONS.SMART_TOY}
              />
            </Grid>
            <Grid item xs={12} sm={6} md={3}>
              <MetricCard
                label="System Load"
                value={`${metrics.systemLoad}%`}
                trend="Normal range"
                icon={ICONS.SPEED}
              />
            </Grid>
            <Grid item xs={12} sm={6} md={3}>
              <MetricCard
                label="Response Time"
                value={`${metrics.responseTime}s`}
                trend="-0.1s from average"
                icon={ICONS.TIMER}
              />
            </Grid>
            <Grid item xs={12} sm={6} md={3}>
              <MetricCard
                label="Success Rate"
                value={`${metrics.successRate}%`}
                trend="Above target"
                icon={ICONS.CHECK_CIRCLE}
              />
            </Grid>
          </Grid>

          <Grid container spacing={3} sx={{ mt: 2 }}>
            <Grid item xs={12} md={6}>
              <Paper className="chart-container">
                <Typography variant="h6" gutterBottom>
                  Agent Activity
                </Typography>
                <div id="activityChart" style={{ height: '100%' }} />
              </Paper>
            </Grid>
            <Grid item xs={12} md={6}>
              <Paper className="chart-container">
                <Typography variant="h6" gutterBottom>
                  System Resources
                </Typography>
                <div id="resourceChart" style={{ height: '100%' }} />
              </Paper>
            </Grid>
          </Grid>

          <Paper className="activity-list" sx={{ mt: 3 }}>
            <Typography variant="h6" gutterBottom>
              Recent Activity
            </Typography>
            <List>
              {recentActivity.map(activity => (
                <ActivityItem key={activity.id} activity={activity} />
              ))}
            </List>
          </Paper>

          {isLoading && (
            <LinearProgress sx={{ position: 'fixed', bottom: 0, left: 0, right: 0 }} />
          )}
        </Box>
      );
    }

    ReactDOM.render(<Dashboard />, document.getElementById('root'));
  </script>
</body>
</html> 