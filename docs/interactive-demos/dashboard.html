<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - Interactive Demo</title>
  <link rel="stylesheet" href="../css/shared-demo.css">
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .metric-card {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 20px;
      position: relative;
      overflow: hidden;
    }
    
    .metric-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
    }
    
    .metric-value {
      font-size: 32px;
      font-weight: bold;
      margin: 10px 0;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .metric-label {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.7);
    }
    
    .chart-container {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .chart-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 20px;
    }
    
    .chart {
      height: 300px;
    }
    
    .activity-list {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 8px;
      padding: 20px;
    }
    
    .activity-item {
      display: flex;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .activity-item:last-child {
      border-bottom: none;
    }
    
    .activity-icon {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--primary-color);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
    }
    
    .activity-details {
      flex: 1;
    }
    
    .activity-time {
      color: rgba(255, 255, 255, 0.5);
      font-size: 12px;
    }
    
    .status-indicator {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-right: 8px;
    }
    
    .status-healthy { background-color: #4CAF50; }
    .status-warning { background-color: #FFC107; }
    .status-error { background-color: #F44336; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Dashboard</h1>
    <p class="subtitle">Real-time monitoring of SafeAI system performance</p>

    <div class="metrics-grid">
      <div class="metric-card">
        <div class="metric-label">Active Agents</div>
        <div class="metric-value" id="activeAgents">12</div>
        <div class="metric-trend">+2 from last hour</div>
      </div>
      <div class="metric-card">
        <div class="metric-label">System Load</div>
        <div class="metric-value" id="systemLoad">45%</div>
        <div class="metric-trend">Normal range</div>
      </div>
      <div class="metric-card">
        <div class="metric-label">Response Time</div>
        <div class="metric-value" id="responseTime">0.8s</div>
        <div class="metric-trend">-0.1s from average</div>
      </div>
      <div class="metric-card">
        <div class="metric-label">Success Rate</div>
        <div class="metric-value" id="successRate">99.9%</div>
        <div class="metric-trend">Above target</div>
      </div>
    </div>

    <div class="chart-grid">
      <div class="chart-container">
        <h2>Agent Activity</h2>
        <div class="chart" id="activityChart"></div>
      </div>
      <div class="chart-container">
        <h2>System Resources</h2>
        <div class="chart" id="resourcesChart"></div>
      </div>
    </div>

    <div class="activity-list">
      <h2>Recent Activity</h2>
      <div id="activityList">
        <!-- Activity items will be dynamically added here -->
      </div>
    </div>
  </div>

  <script>
    class Dashboard {
      constructor() {
        this.metrics = {
          activeAgents: 12,
          systemLoad: 45,
          responseTime: 0.8,
          successRate: 99.9
        };
        
        this.activityData = Array.from({length: 24}, (_, i) => ({
          time: i,
          ethics: Math.random() * 30 + 20,
          math: Math.random() * 30 + 20,
          arc: Math.random() * 30 + 20,
          security: Math.random() * 30 + 20
        }));
        
        this.resourceData = Array.from({length: 60}, (_, i) => ({
          time: i,
          cpu: Math.random() * 30 + 40,
          memory: Math.random() * 20 + 50,
          network: Math.random() * 25 + 35
        }));
        
        this.recentActivity = [
          {
            agent: 'Ethics Agent',
            action: 'Completed value alignment check',
            time: '2 minutes ago',
            status: 'healthy'
          },
          {
            agent: 'Security Monitor',
            action: 'Detected and blocked suspicious activity',
            time: '5 minutes ago',
            status: 'warning'
          },
          {
            agent: 'Math Agent',
            action: 'Solved complex optimization problem',
            time: '10 minutes ago',
            status: 'healthy'
          }
        ];
        
        this.initializeCharts();
        this.updateActivityList();
        this.startRealTimeUpdates();
      }

      initializeCharts() {
        // Agent Activity Chart
        const activityData = [{
          type: 'scatter',
          mode: 'lines',
          name: 'Ethics Agent',
          x: this.activityData.map(d => d.time),
          y: this.activityData.map(d => d.ethics),
          line: { color: '#4CAF50' }
        }, {
          type: 'scatter',
          mode: 'lines',
          name: 'Math Agent',
          x: this.activityData.map(d => d.time),
          y: this.activityData.map(d => d.math),
          line: { color: '#2196F3' }
        }, {
          type: 'scatter',
          mode: 'lines',
          name: 'ARC Agent',
          x: this.activityData.map(d => d.time),
          y: this.activityData.map(d => d.arc),
          line: { color: '#FFC107' }
        }, {
          type: 'scatter',
          mode: 'lines',
          name: 'Security Agent',
          x: this.activityData.map(d => d.time),
          y: this.activityData.map(d => d.security),
          line: { color: '#F44336' }
        }];

        const activityLayout = {
          paper_bgcolor: 'rgba(0,0,0,0)',
          plot_bgcolor: 'rgba(0,0,0,0)',
          font: { color: '#fff' },
          showlegend: true,
          legend: {
            bgcolor: 'rgba(0,0,0,0.5)',
            bordercolor: 'rgba(255,255,255,0.1)',
            borderwidth: 1
          },
          margin: { t: 10, r: 10, b: 40, l: 40 },
          xaxis: {
            showgrid: false,
            title: 'Hour'
          },
          yaxis: {
            showgrid: true,
            gridcolor: 'rgba(255,255,255,0.1)',
            title: 'Activity Level (%)'
          }
        };

        Plotly.newPlot('activityChart', activityData, activityLayout);

        // System Resources Chart
        const resourceData = [{
          type: 'scatter',
          mode: 'lines',
          name: 'CPU',
          x: this.resourceData.map(d => d.time),
          y: this.resourceData.map(d => d.cpu),
          line: { color: '#4CAF50' }
        }, {
          type: 'scatter',
          mode: 'lines',
          name: 'Memory',
          x: this.resourceData.map(d => d.time),
          y: this.resourceData.map(d => d.memory),
          line: { color: '#2196F3' }
        }, {
          type: 'scatter',
          mode: 'lines',
          name: 'Network',
          x: this.resourceData.map(d => d.time),
          y: this.resourceData.map(d => d.network),
          line: { color: '#FFC107' }
        }];

        const resourceLayout = {
          paper_bgcolor: 'rgba(0,0,0,0)',
          plot_bgcolor: 'rgba(0,0,0,0)',
          font: { color: '#fff' },
          showlegend: true,
          legend: {
            bgcolor: 'rgba(0,0,0,0.5)',
            bordercolor: 'rgba(255,255,255,0.1)',
            borderwidth: 1
          },
          margin: { t: 10, r: 10, b: 40, l: 40 },
          xaxis: {
            showgrid: false,
            title: 'Time (minutes)'
          },
          yaxis: {
            showgrid: true,
            gridcolor: 'rgba(255,255,255,0.1)',
            title: 'Usage (%)'
          }
        };

        Plotly.newPlot('resourcesChart', resourceData, resourceLayout);
      }

      updateActivityList() {
        const container = document.getElementById('activityList');
        container.innerHTML = this.recentActivity.map(activity => `
          <div class="activity-item">
            <div class="activity-icon">
              <div class="status-indicator status-${activity.status}"></div>
            </div>
            <div class="activity-details">
              <div>${activity.agent}</div>
              <div>${activity.action}</div>
              <div class="activity-time">${activity.time}</div>
            </div>
          </div>
        `).join('');
      }

      updateMetrics() {
        // Update metric values with small random changes
        this.metrics.activeAgents += Math.random() > 0.5 ? 1 : -1;
        this.metrics.systemLoad += (Math.random() - 0.5) * 5;
        this.metrics.responseTime += (Math.random() - 0.5) * 0.1;
        this.metrics.successRate = Math.min(100, this.metrics.successRate + (Math.random() - 0.5) * 0.1);

        // Update DOM
        document.getElementById('activeAgents').textContent = Math.max(0, Math.round(this.metrics.activeAgents));
        document.getElementById('systemLoad').textContent = Math.max(0, Math.min(100, Math.round(this.metrics.systemLoad))) + '%';
        document.getElementById('responseTime').textContent = Math.max(0, this.metrics.responseTime.toFixed(1)) + 's';
        document.getElementById('successRate').textContent = this.metrics.successRate.toFixed(1) + '%';
      }

      updateCharts() {
        // Update activity data
        this.activityData.shift();
        this.activityData.push({
          time: this.activityData[this.activityData.length - 1].time + 1,
          ethics: Math.random() * 30 + 20,
          math: Math.random() * 30 + 20,
          arc: Math.random() * 30 + 20,
          security: Math.random() * 30 + 20
        });

        // Update resource data
        this.resourceData.shift();
        this.resourceData.push({
          time: this.resourceData[this.resourceData.length - 1].time + 1,
          cpu: Math.random() * 30 + 40,
          memory: Math.random() * 20 + 50,
          network: Math.random() * 25 + 35
        });

        // Update plots
        Plotly.update('activityChart', {
          x: [
            this.activityData.map(d => d.time),
            this.activityData.map(d => d.time),
            this.activityData.map(d => d.time),
            this.activityData.map(d => d.time)
          ],
          y: [
            this.activityData.map(d => d.ethics),
            this.activityData.map(d => d.math),
            this.activityData.map(d => d.arc),
            this.activityData.map(d => d.security)
          ]
        });

        Plotly.update('resourcesChart', {
          x: [
            this.resourceData.map(d => d.time),
            this.resourceData.map(d => d.time),
            this.resourceData.map(d => d.time)
          ],
          y: [
            this.resourceData.map(d => d.cpu),
            this.resourceData.map(d => d.memory),
            this.resourceData.map(d => d.network)
          ]
        });
      }

      startRealTimeUpdates() {
        setInterval(() => {
          this.updateMetrics();
          this.updateCharts();
        }, 2000);
      }
    }

    // Initialize the dashboard when the page loads
    document.addEventListener('DOMContentLoaded', () => {
      window.dashboard = new Dashboard();
    });
  </script>
</body>
</html> 